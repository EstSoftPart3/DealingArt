<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
	<title>딜링아트</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="theme-color" content="#000000">
	
	<meta name="author" content="">
	<meta name="keywords" content="미술,아트,경매,수수료,정찰,운송,보험,직거래,dealingart">
	<meta name="description" content="미술품 거래의 새로운 트렌드">
	<meta property="og:description" content="미술품 거래의 새로운 트렌드">
	<meta property="og:type" content="website">
	<meta property="og:title" content="딜링아트">
	<meta property="og:image" content="https://www.dealing-art.com/resources/img/DA_logo_og.png">
	<meta property="og:url" content="https://www.dealing-art.com">
	
	<meta name="robots"content="noindex">
	
	<!-- google -->
    <meta name="google-site-verification" content="EKiW_Lm3Qw-DYnLT9qokEpZT2Sa8tSQuVWhVEvs4kPk" />
    <!-- faceBook -->
    <meta name="facebook-domain-verification" content="bgotqya9tcsrgrmspnq0uywh85kjzh" />
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- HTML의 <head> 섹션에 전체 사이트 태그를 복사합니다. -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-WRJBSR52MT"></script>
	
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	
	  gtag('config', 'G-WRJBSR52MT');
	</script>
	
	<!-- Google Tag Manager -->
	<!-- 페이지의 <head>에서 가능한 한 높은 위치에 코드를 붙여넣으세요. -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-NBP5CQ9');</script>
	<!-- End Google Tag Manager -->
			
	<!-- Google Tag Manager (noscript) -->
	<!-- 또한 여는 <body> 태그 바로 뒤에 코드를 붙여넣으세요. -->
	<noscript>
		<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NBP5CQ9"height="0" width="0" style="display:none; visibility:hidden"></iframe>
	</noscript>
	<!-- End Google Tag Manager (noscript) -->
	
	
	<!-- 페이스북 Meta Pixel Code -->
	<script>
	  !function(f,b,e,v,n,t,s)
	  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
	  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
	  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
	  n.queue=[];t=b.createElement(e);t.async=!0;
	  t.src=v;s=b.getElementsByTagName(e)[0];
	  s.parentNode.insertBefore(t,s)}(window, document,'script',
	  'https://connect.facebook.net/en_US/fbevents.js');
	  fbq('init', '5995234030505207');
	  fbq('track', 'PageView');
	</script>
	<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=5995234030505207&ev=PageView&noscript=1"/></noscript>
    
    <style>
    	.head-wrap{border-bottom:#e9e9e9 1px solid;}
    	.swi-box::before{background-color:#f9f9f9;}
    	.footer-wrap{margin-top:0;}
    	.hd-div{background-color:#fff;}
    	[name=COLLworkClrCd]:checked+label{
		  outline: 5px solid gray;
		}
		[name=WORKworkClrCd]:checked+label{
		  outline: 5px solid gray;
		}
		/* Chrome, Safari, Edge, Opera */
		input::-webkit-outer-spin-button,
		input::-webkit-inner-spin-button {
		  -webkit-appearance: none;
		  margin: 0;
		}
		/* Firefox */
		input[type=number] {
		  -moz-appearance: textfield;
		}
    </style>
    
    <link rel="icon" type="image/png" href="/resources/img/favicon.png">
    <link type="text/css" rel="stylesheet" href="/resources/css/common_new.css"/>
</head>
<body>
	<th:block th:replace="thymeleaf/header :: headerFragment"></th:block>
    <div id="container">
        <div class="community_wrap">
            <div id="nav">
            	<ul>
                     <li><a href="/community/mainMobile">홈</a></li>
                    <li><a href="/community/worksListMobile" class="over">작품자랑</a></li>
                    <li><a href="/community/exhintListMobile">전시후기&소개</a></li>
                    <li><a href="/community/issueListMobile">이슈</a></li>
                    <li><a href="/community/eventMobile">이벤트</a></li>   
                </ul>
            </div>
			<button class="btn_recording" onclick="location.href='/myPage/mypage_mainMobile'">기록하기</button>
            <div class="input_wrap">
                <div class="input_cal" style="display: inline; position: static;">
                	<input type="date" id="startDate" onchange="checkCalendar()" class="mb10">
                	<span>~</span>
                	<input type="date" id="endDate" onchange="checkCalendar()" class="mb10">
                	<div class="sel_sorting width33per">
	                    <select class="exhSelectBox" name="comtSort" id="comtSort">
	                        <option value="">정렬</option>
	                        <option value="newest">최신순</option>
	                        <option value="byRecentPopularity">최근 인기 순</option>
	                        <option value="allTimePopularity">역대 인기 순</option>
	                        <option value="pastOrder">과거 순</option>
	                    </select>
	                </div>
                    <div class="sel_form width33per">
	                    <select class="exhSelectBox" name="exhibitRegionCd" id="exhibitRegionCd">
	                        <option value="">지역</option>
	                    </select>
	                </div>
	                <div class="sel_form width33per">
	                    <select class="exhSelectBox" name="exhibitTypCd" id="exhibitTypCd">
	                        <option value="">구분</option>
	                    </select>
	                </div>
                </div>
            </div>
            <div class="notice dp-flex">
                <div class="tit">공 지</div>
                <div class="contents mt0">
                	<div>작품자랑 작성 가이드 라인 ver 1.0</div>
                </div>
            </div>
            <div class="exhint_wrap" id="listBox">
                
                <div class="pagination">
                    <div class="paginate" id="paginate">                        
                        
                    </div>
                </div>
            </div>  
        </div>
    </div>
    <th:block th:replace="thymeleaf/footer :: footerFragment"></th:block>
    
    <script>
    var offset = 0;
    var nowPage = 0;
   	var startDate = '';
   	var endDate = '';
   	var obj = new Object();
   	
   	var pageNextBtnCount = 0;
   	var endPage = 0;
   	var startPage = 0;
   	var realEndPage = 0;
   	var prev = false;
   	var next = false;
   
   	$(document).ready(function(){
   		
   		// select 지역구분코드 생성하기
   		getDtlCdNm("/community/getExhibitRegionCdNm", "exhibitRegionCd", '38');
   		getDtlCdNm("/community/getExhibitTypCdNm", "exhibitTypCd", '37');
   		
   		// 커뮤니티 전시후기/소개 뿌려주기
   		communityExhibitList();
   		
   		// select 정렬 값 선택시 데이터 검색
   		$(".exhSelectBox").on("change", function(){
   			
   			var id = $(this).attr("id");
   			obj[id] = $(this).val();
   			offset = 0;
   			nowPage = 0;
   			communityExhibitList();
   		});

   	});

   	// 캘린더 선택시 조회하기 
   	function checkCalendar(){
   		startDate = $("#startDate").val();
   		endDate = $("#endDate").val();
   		
   		if(startDate != '' && endDate != ''){
   			offset = 0;
   			nowPage = 0;
   			communityExhibitList();
   		}
   	}
   	
   	// 커뮤니티 전시후기/소개 뿌려주기
   	function communityExhibitList(){
   		
   		obj.comtTypCd = "EXH";
   		obj.startDate = startDate;
   		obj.endDate = endDate;
   		obj.limit = 10;
   		obj.offset = nowPage * 10

   		$.ajax({
   			type: "POST",
   			url: "/community/communityListData",
   			data: obj,
   			success: (function(response){
   				setExhibitHtml(response.result);
   				setPagenation(response.totalCount);
   			}),
   			error: (function(response){
   				console.log(response);
   			})
   		});
   		
   	}
   	
   	// 전시후기/소개 뿌려주기
   	function setExhibitHtml(list){
   		var strHtml = '';
   		
   		window.scrollTo({top:0});
   		list.forEach( function (exhibit) {
   			
   			strHtml += '<div class="exhint_row" id="exhibit_'+ exhibit.comtSq +'">';
   	        strHtml += '    <div class="exhint_list_img"><img src="'+ exhibit.comtImgUrl +'" class="img-fit-contain" onclick="opneExhibit('+ exhibit.comtSq +')" style="cursor: pointer;" alt=""></div>';
   	        strHtml += '    <div class="contents">';
   	        strHtml += '        <ul>';
   	        
   	     	strHtml += '			<div onclick="opneExhibit('+ exhibit.comtSq +')" style="cursor: pointer;">';
   	        strHtml += '            	<li>';
   	        strHtml += '                	<div class="tit">';
   	        strHtml += '                    	<em>'+ exhibit.comtTitle +'</em><div class="ico_new">NEW</div>';
   	        strHtml += '                	</div>';
   	        strHtml += '            	</li>';
   	        strHtml += '            	<li class="comt_content pt20">'+ exhibit.comtContent +'</li>';
   	        strHtml += '            </div>';
   	        
   	        strHtml += '            <li class="comt-row-info">';
   	        strHtml += '                <div class="user_wrap">';
   	        strHtml += '                    <div class="user">';
   	        strHtml += '                        <ul>';
   	        
   	        if(null != exhibit.mbrProfileImgUrl){
   	        	strHtml += '                            <li class="pt5"><img src="'+ exhibit.mbrProfileImgUrl +'" alt=""></li>';
   	        } else {
   	        	strHtml += '                            <li class="pt5"><img src="/resources/img/mypage/ico_dauser.png" alt=""></li>';
   	        }
   	        
   	        strHtml += '                            <li class="user_name"><span>'+ exhibit.mbrNcknm +'</span></li>';
   	        strHtml += '                        </ul>';
   	        strHtml += '                    </div>';
   	        strHtml += '                    <div class="icon_box">';
   	        strHtml += '                        <ul>';
   	        strHtml += '                            <li><p class="ico_good"></p><span>'+ exhibit.comtLikes +'</span></li>';
   	        strHtml += '                            <li><p class="ico_scrap"></p><span>'+ exhibit.comtScraps +'</span></li>';
   	        strHtml += '                            <li><p class="ico_hits"></p><span>'+ exhibit.comtViews +'</span></li>';
   	        strHtml += '                            <li><p class="ico_comments"></p><span>'+ exhibit.comtCmts +'</span></li>';
   	        strHtml += '                        </ul>';
   	        strHtml += '                    </div>';
   	        strHtml += '                </div>';
   	        strHtml += '            </li>';
   	        strHtml += '        </ul>';
   	        strHtml += '    </div>';
   	        strHtml += '</div>';
   	        
   		});
   		
   		$("#listBox .exhint_row").remove();
        $("#listBox").prepend(strHtml);
   		setContentText($(".comt_content"));
   	}
   	
   	// 작성 글 내용 텍스트만 가져오기
   	function setContentText(content) {
   		// ck에디터 태그 제외하기 위한 정규식
   		var regex = /ck-/;
   		
   		$.each(content, function(idx, item) {
   			var childTags = $(item).children();
   			var text = "";
   			
   			$.each(childTags, function(idx, item) {
   				var tagClasses = $(item).attr("class");
   				
   				// 클래스가 있을 경우
   				if(tagClasses) {
   					// ck-로 시작하는 클래스명이 없을 경우 텍스트를 가져옴
   					if(tagClasses.search(regex) === -1) {
   						text += $(item).text();
   					}
   				} else {
   					text += $(item).text();
   				}
   			});
   			
   			$(item).html(text);
   		});
   	}
   	
   	function opneExhibit(comtSq){
   		location.href = "/community/exhibitDetail?SqNumber=" + comtSq;
	}

   	// ajax로 공통코드 들고와서 뿌려주기
   	function getDtlCdNm(url, selectBoxId, cdSq){
   		
   		$.ajax({
       		url: url,
       		data: {cdSq: cdSq},
       		success: function(response){
       			setDtlCdNm(response.result, selectBoxId);
       		},
       		error : function(response){
       			
       		}
       	});
   	}

   	// select option 셋팅
   	function setDtlCdNm(list, selectBoxId){
   		
   		var strHtml = '';
   		
   		list.forEach(function(value){
   			strHtml += '<option value="'+ value.dtlCd +'">'+ value.dtlCdNm +'</option>'
   		});
   		
   		$("#"+ selectBoxId).append(strHtml);
   	}
   	
 	// 페이지네이션 그려주기 
 	function setPagenation(count){
 		
 		$("#paginate").empty();

 		var strHtml = '';
 		var totalCount = count.totalCount;
 		var i = 0;

 		realEndPage = Math.ceil( totalCount / 10 );												// 최종 페이지
 		endPage = Math.ceil( realEndPage / 10 ) > 10 ? 10 : realEndPage % 10;					// 10개씩 보여줄 마지막 페이지
 		next = ( Math.ceil( realEndPage / 10 ) ) > pageNextBtnCount + 1 ? true : false;			// 다음 10개버튼 보여주기 위한 boolean
 		prev = pageNextBtnCount > 0 ? true : false;
		
 		// 이전 페이지
 		if(prev) {
 			strHtml += '<a href="javascript:pageNextBtnCount = 0; nowPage = 0; communityExhibitList();" class="next_end ml5"></a>';
 			strHtml += '<a href="javascript:pageNextBtnCount--; nowPage = 10 * pageNextBtnCount; communityExhibitList();" class="next ml10"></a>'
 		}
 		
 		// 페이지 넘버
 		for(i = 0 * ( pageNextBtnCount * 10 ); i < endPage; i++) {
 			
 			if(nowPage == i) {
 				console.log("들어옴");
 				strHtml += '<a href="javascript:nowPage ='+ i +'; communityExhibitList();"><strong>'+ ( i + 1 ) +'</strong></a>';
 			} else {
	 			strHtml += '<a href="javascript:nowPage ='+ i +'; communityExhibitList();">'+ ( i + 1 ) +'</a>';
 			}
 		}
 		
 		// 다음 페이지
 		if(next){
 			strHtml += '<a href="javascript:pageNextBtnCount++; nowPage = 10 * pageNextBtnCount; communityExhibitList();" class="next ml10"></a>'
 			
 			var finalPage = Math.ceil( realEndPage / 10 );
 			strHtml += '<a href="javascript:pageNextBtnCount = finalPage - 1; nowPage = ( finalPage - 1 ) * 10 ; communityExhibitList();" class="next_end ml5"></a>';
 		}

 		$("#paginate").append(strHtml);
 		
 	}

    </script>
</body>
</html>