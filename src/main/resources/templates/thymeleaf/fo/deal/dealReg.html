<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
    	.head-wrap{border-bottom:#e9e9e9 1px solid;}
    	.swi-box::before{background-color:#f9f9f9;}
    	.footer-wrap{margin-top:0;}
    	.hd-div{background-color:#fff;}
    	input[type="radio"] + label{margin-bottom:0;}
    	.timepicker{
    		width: 100px;
    		height: 32px;
  			border: #cccccc 1px solid;
    		font-size: 14px;
    	}
    	.addrBtn{
	    	width: 20%;
		    background: #999999;
		    font-size: 16px;
		    color: #fff;
		    font-weight: 600;
		    height: 48px;
		    margin-left: 10px;
    	}
    </style>
</head>

<body>
	<div class="wrap">
		<th:block th:replace="thymeleaf/header :: headerFragment"></th:block>  
		
		<div class="body-wrap">
			
			<div class="contents max-1500">
				<div class="sub-title">
					<h3 class="" id="dealRegTitle">거래 등록 (경매)</h3>
				</div>
				
				<div class="baeg-wrap">
					<div class="baeg-left">
						<img th:src="${result.work.workMainImgUrl}" style="width:98%;"/>
					</div>
					<div class="baeg-right">
					
						<div class="med">
							<h2 class="mo-mt100">판매방식</h2>
							<div class="med-ic">
								<div class="por">
									<div class="tootip-4">거래 전<br/>꼭! 확인하세요</div>
									<img src="resources/img/ba/me-icon.png" class="med-me" />
								</div>
							</div>
							<div class="med-box radio-2">
								<input type="radio" id="r1" name="dealTypCd" value="A" checked>
								<label for="r1" class="wd-145"><span></span>경매</label>
								<input type="radio" id="r2" name="dealTypCd" value="S">
								<label for="r2"><span></span>정찰가</label>
							</div>
						</div>
						
						<div class="med">
							<h2>기간설정</h2>
							<div class="med-box radio-2">
								<input type="radio" id="w1" name="dealPeriod" value="start" checked>
								<label for="w1" class="wd-145"><span></span>즉시 시작</label>
								<input type="radio" id="w2" name="dealPeriod" value="choice">
								<label for="w2"><span></span>시작 시간 선택</label>
								
								<ul class="med-ul" id="startDate">
									<li onclick="startDateSel(this)" value="7"><a href="#" >1주</a></li>
									<li onclick="startDateSel(this)" value="14"><a href="#">2주</a></li>
									<li onclick="startDateSel(this)" value="21"><a href="#">3주</a></li>
									<li onclick="startDateSel(this)" value="28"><a href="#">4주</a></li>
									<li onclick="startDateSel(this)" value="35"><a href="#">5주</a></li>
								</ul>
								<div class="input-box" id="choiceDate" style="display:none;">
									<label style="margin: 0; padding: 0 10px 0 0px; display: inline-block; font-size: 14px; color: #333; vertical-align: middle;">기간선택</label>
									<div class="input-cand"><input type="text" class="datepicker" id="dealStrtDt" placeholder="거래 시작 날짜"/></div>
									<input type="text" class="timepicker" id="dealStrtTime" required>
									<span class="is-span">~</span> 
									<div class="input-cand"><input type="text" class="datepicker" id="dealEndngDt" placeholder="거래 종료 날짜"></div>
									<input type="text" class="timepicker" id="dealEndngTime" required>
								</div>
							</div>
						</div>
						
						<div class="med">
							<h2 id="bidOrSale">낙찰 희망가</h2>
							<div class="med-box radio-2">
								<div id="bidOrSale2">
									<input type="radio" id="t1" name="cc" checked>
									<label for="t1" class="c-red" ><span></span>경매 시작가 <div class="mg_l30 di-b" id="dealStrtPrcA"></div></label>
									<span class="to-red" style="font-size:12px;">판매 희망가의 70%로 자동 설정 됩니다.</span>
								</div>
								<div class="input-box">
									<input type="text" class="input-1" id="dealStrtPrcA1" placeholder="희망가를 입력해주세요" onkeyup="comma(this)" onblur="dealStrtPrcCal(this)" style="font-size:15px;"/>
									<input type="text" class="input-1" id="dealStrtPrcS" placeholder="판매가를 입력해주세요" onkeyup="comma(this)" onblur="dealStrtPrcCal(this)" style="font-size:15px; display:none;"/>
								</div>
							</div>
						</div>
						
						<div class="med">
							<h2>배송 시작 주소</h2>
							<div class="med-box radio-2">
								<input type="radio" id="q1" name="delivryAddr" class="user-on" value="O" checked>
								<label for="q1" class="wd-185"><span></span>회원 정보와 동일</label>
								<input type="radio" id="q2" name="delivryAddr" class="home-on" value="N">
								<label for="q2"><span></span>새로운 주소</label>
								
								<div class="home-1">
									<table class="tstyle3">
										<tr>
											<th>보내는 사람</th>
											<td th:text="${result.mbrInfo.mbrNm}"></td>
										</tr>
										<tr>
											<th>주 소</th>
											<td th:text="${result.mbrInfo.mbrDelivryAddr}"></td>
										</tr>
										<tr>
											<th>휴대전화</th>
											<td th:text="${result.mbrInfo.mbrDelivryCpNum}"></td>
										</tr>
									</table>
								</div>
								
								<div class="home-2" style="display:none;">
									<div class="input-box">
										<input type="text" class="input-2" style="font-size:14px;" th:value="${result.mbrInfo.mbrNm}" readonly disabled/>
										<span class="span-in">보내는 사람</span>
									</div>
										
									<div class="input-box">
										<input type="text" class="input-2" style="width:78%; font-size:14px;" placeholder="우편번호를 검색하세요." id="mbrDelivryAddr" readonly disabled/>
										<span class="span-in">기본 주소</span>
										<button type="button" class="addrBtn" onclick="searchAddr()">우편번호 검색</button>
										
									</div>
									<div class="input-box">
										<input type="text" class="input-2" placeholder="상세주소를 입력하세요." style="font-size:14px;" id="mbrDelivryAddrDetail"/>
										<span class="span-in">상세 주소</span>
									</div>
									<div class="input-box">
										<input type="text" class="input-2" style="font-size:14px;" id="mbrDelivryCpNum" th:value="${result.mbrInfo.mbrDelivryCpNum}" onkeyup="inputPhoneNumber(this)"/>
										<span class="span-in">휴대전화</span>
									</div>
								</div>
							</div>
							
						</div>
					<div id="auctionInfo">
						<div class="med col_t85" style="padding:15px;">
							<h2 class="">거래 등록 정보 <span class="c-gra">등록된 작품을 거래로 전환할 때 필요한 정보 입니다.</span></h2>
						</div>
						<div class="myd-box">
							<div class="myd-box-2">
								
								<table class="mstyle-2">
									<tr>
										<th><span class="my-red">보증서</span></th>
										<td>
											<div class="filebox bs3-primary">
												<!-- <input class="upload-name" value="파일선택" disabled> -->
												<th:block th:if="${not #strings.isEmpty(result.work.workGrtUrl)}">
													<img class="content" id="workGrtUrl1" style="cursor:pointer" th:src="${result.work.workGrtUrl}"/>
												</th:block>
												<th:block th:unless="${not #strings.isEmpty(result.work.workGrtUrl)}">
													<img class="content" id="workGrtUrl1" style="cursor:pointer"/>
												</th:block>
												<label for="workGrtUrl">찾아보기</label> 
												<input type="file" id="workGrtUrl" class="upload-hidden" accept=".jpeg, .jpg, .png, .pdf" th:value="${result.work.workGrtUrl}"> 
											</div>
											<p class="table-p">
												※ png, jpeg, pdf 형식으로 등록 해주세요<br/>
												※ 향후에 거래로 등록 할 때에는 보증서 등록이 필요합니다. 보증서를 분실하셨다면 구매처에 재발급을 요청하시기 바랍니다.
											</p>
										</td>
									</tr>
									<tr>
										<th><span class="my-red">소장가</span></th>
										<td>
											<input type="text" class="input-4" id="workPrc" th:value="${result.work.workPrc}" onkeyup="comma(this)" placeholder="작품의 소장 가격을 입력해주세요." style="font-size:15px;"/>
										</td>
									</tr>
									<tr>
										<th><span class="">작품 사진(좌)</span></th>
										<td>
											<div class="filebox bs3-primary">
												<!-- <input class="upload-name" value="파일선택" disabled="disabled"> -->
												<img class="content" id="workImgLefUrl1" style="cursor:pointer" th:src="${result.work.workImgLefUrl}"/>
												<label for="workImgLefUrl">찾아보기</label> 
												<input type="file" id="workImgLefUrl" class="upload-hidden" th:value="${result.work.workImgLefUrl}"> 
											</div>
											<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
										</td>
									</tr>
									<tr>
										<th><span class="">작품 사진(우)</span></th>
										<td>
											<div class="filebox bs3-primary">
												<!-- <input class="upload-name" value="파일선택" disabled> -->
												<img class="content" id="workImgRitUrl1" style="cursor:pointer" th:src="${result.work.workImgRitUrl}"/>
												<label for="workImgRitUrl">찾아보기</label> 
												<input type="file" id="workImgRitUrl" class="upload-hidden" th:value="${result.work.workImgRitUrl}"> 
											</div>
											<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
										</td>
									</tr>
									<tr>
										<th><span class="">작품 사진(상)</span></th>
										<td>
											<div class="filebox bs3-primary">
												<!-- <input class="upload-name" value="파일선택" disabled="disabled"> -->
												<img class="content" id="workImgTopUrl1" style="cursor:pointer" th:src="${result.work.workImgTopUrl}"/>
												<label for="workImgTopUrl">찾아보기</label> 
												<input type="file" id="workImgTopUrl" class="upload-hidden" th:value="${result.work.workImgTopUrl}"> 
											</div>
											<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
										</td>
									</tr>
									<tr>
										<th><span class="">작품 사진(하)</span></th>
										<td>
											<div class="filebox bs3-primary">
												<!-- <input class="upload-name" value="파일선택" disabled="disabled"> -->
												<img class="content" id="workImgBotUrl1" style="cursor:pointer" th:src="${result.work.workImgBotUrl}"/>
												<label for="workImgBotUrl">찾아보기</label> 
												<input type="file" id="workImgBotUrl" class="upload-hidden" th:value="${result.work.workImgBotUrl}"> 
											</div>
											<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
										</td>
									</tr>
									<tr>
										<th>작품영상</th>
										<td><input type="text" class="input-4" id="workVideoUrl" placeholder="홈페이지, SNS 등 본 작품과 관련된 영상 링크를 기재해 주세요." th:value="${result.work.workVideoUrl}"/></td>
									</tr>
									<tr>
										<th>작품소개</th>
										<td><textarea class="textarea-2" id="workIntrdc" placeholder="작품소개를 입력해주세요." th:value="${result.work.workIntrdc}" th:text="${result.work.workIntrdc}"></textarea></td>
									</tr>
									<tr>
										<th><span class="">작품 키워드</span></th>
										<td>
											<input type="text" class="input-4" id="keywrd" placeholder="키워드를 쉼표로 구분해주세요." onblur="keywrdSet(this)" th:value="${result.work.keywrd}"/>
											<div class="key-box">
											</div>
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
						
						<div class="bat-box2">
							<button type="button" class="ba-btn1" data-toggle="modal" data-target="#myModal4" id="btn_dealReg"><span>경매 시작하기</span></button>
						</div>
						
					</div>
				</div>
			</div>
			
			
		</div>
		<th:block th:replace="thymeleaf/footer :: footerFragment"></th:block>
	</div>


<!-- 거래 등록 전 꼭! 확인하세요 -->
<div class="modal fade modal-s" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModal3Label" aria-hidden="true" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog modal-baeg max-w530">
		<div class="modal-content">
			<div class="modal-header">
				<div class="baegs">
					<h2>거래 등록 전 <br/>꼭! 확인하세요</h2>
				    <img src="resources/img/ba/icon-1.png" class="con-img" />
				    <!-- <div class="close" onclick="javascript:window.history.back();"><img src="resources/img/ba/icon-end.png" /></div> -->
				</div>

			</div>
			<div class="modal-body">
				<div class="md-box-1">
					<p class="min-h240">
					위작, 허위판매 등 신고 사유를 가능한 상세히 작성해 주시기 바랍니다.<br />
					허위 신고는 제재를 받을 수 있으며 민형사상의 법적 책임을 물을 수 있습니다.
					</p>
					
					<div class="baeg-btn mg_t30">
						<a href="#"><button type="button" class="baeg-b1" data-dismiss="modal" aria-label="Close">확인</button></a>
						<a href="javascript:window.history.back();"><button type="button" class="baeg-b2">취소</button></a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- 신고하기 완료 -->
<div class="modal fade modal-s" id="myModal4" tabindex="-1" role="dialog" aria-labelledby="myModal4Label" aria-hidden="true">
	<div class="modal-dialog modal-baeg max-w530">
		<div class="modal-content">
			<div class="modal-header" style="height: 0; min-height: 0; padding: 0;">
				<div class="baegs">
				    <div class="close" data-dismiss="modal" aria-label="Close"><img src="resources/img/ba/icon-end.png" /></div>
				</div>

			</div>
			<div class="modal-body">
				<div class="md-box-1">
					<div class="md-ds" style="color:#333;">
						경매가 시작되면 취소할 수 없습니다.<br/>
						신중히 결정해 주세요.
					</div>
					
					<div class="baeg-btn mg_t30">
						<a href="#"><button type="button" class="baeg-b1" onclick="dealReg()">확인</button></a>
						<a href="#" data-dismiss="modal" aria-label="Close"><button type="button" class="baeg-b2">취소</button></a>
					</div>
					
				</div>
			</div>
		</div>
	</div>
</div>



<script th:inline="javascript">
var result = /*[[${result}]]*/ 'default';
var deal = new Object();
result.deal = deal;
jQuery(document).ready(function() {
	$('.datepicker').datepicker();
	$("#dealStrtDt").calendar($("#dealEndngDt"));
	if(result.mbrInfo.mbrDelivryAddr == null || result.mbrInfo.mbrDelivryAddr == ""){
		$(".home-1").css("display", "none");
		$(".home-2").css("display", "");
		$("#q1").attr("disabled", true);
		$(".user-on").css("display", "none");
		$("#q2").prop("checked", "true");
	}
	
    $('.timepicker').timepicker({
        timeFormat: 'HH:mm',
        interval: 10,
//         minTime: '10',
//         maxTime: '6:00pm',
        defaultTime: '0',
        startTime: '12:00',
        dynamic: false,
        dropdown: true,
        scrollbar: true
    });
	
});

$("input:radio[name='dealTypCd']").change(function(){
	if($("input:radio[name='dealTypCd']:checked").val() == "S"){
		$("#dealRegTitle").text("거래등록 (정찰가)");
		$("#bidOrSale").text("판매가");
		$("#bidOrSale2").css("display", "none");
		$("#dealStrtPrcA1").css("display", "none");
		$("#dealStrtPrcS").css("display", "");
		$("#btn_dealReg").text("판매 등록하기")
	}else{
		$("#dealRegTitle").text("거래등록 (경매)");
		$("#bidOrSale").text("낙찰 희망가");
		$("#bidOrSale2").css("display", "");
		$("#dealStrtPrcA1").css("display", "");
		$("#dealStrtPrcS").css("display", "none");
	}
}); 

$("input:radio[name='dealPeriod']").change(function(){
	if($("input:radio[name='dealPeriod']:checked").val() == "choice"){
		$("#choiceDate").css("display", "");
		$("#startDate").css("display", "none");
		result.deal.dealStrtDtAddDt = null;
	}else{
		$("#choiceDate").css("display", "none");
		$("#startDate").css("display", "");
	}
});

$.datepicker.setDefaults({
	dateFormat: 'yy.mm.dd',
	prevText: '이전 달',
	nextText: '다음 달',
	monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
	monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
	dayNames: ['일', '월', '화', '수', '목', '금', '토'],
	dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],
	dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],
	showMonthAfterYear: true,
	yearSuffix: '년'
});

function searchAddr(){
	new daum.Postcode({
    	oncomplete: function(data) { //선택시 입력값 세팅
		$("#mbrDelivryAddr").val(data.address); // 주소 넣기
    	}
	}).open();
}

function dealStrtPrcCal(obj){
	var checked = $("input:radio[name='dealTypCd']:checked").val();
	if(checked == "A"){
		if(obj.value != null && obj.value != ""){
			obj.value = obj.value.replaceAll(/,/g,'');          // ,값 공백처리
			obj.value = parseInt(obj.value);
			var n = obj.value % 10000;
			if(n != 0 || obj.value == 0){
				modalAlertShow("10,000원 단위로만 입력가능합니다.", obj.id);
				obj.value = '';
				$("#dealStrtPrcA").text("");
			}else{
				var val = Math.round(obj.value.replaceAll(",", "") * 0.7);
				var val2 = val.toString().replaceAll(/\B(?=(\d{3})+(?!\d))/g, ",");
				$("#dealStrtPrcA").text(val2+" KRW");
			}
			obj.value = obj.value.replaceAll(/\B(?=(\d{3})+(?!\d))/g, ",");
		}
	}else{
		if(obj.value != null && obj.value != ""){
			obj.value = obj.value.replaceAll(/,/g,'');          // ,값 공백처리
			obj.value = parseInt(obj.value);
			var n = obj.value % 10000;
			if(n != 0 || obj.value == 0){
				modalAlertShow("10,000원 단위로만 입력가능합니다.", obj.id);
				obj.value = '';
				$("#dealStrtPrcA").text("");
			}
			obj.value = obj.value.replaceAll(/\B(?=(\d{3})+(?!\d))/g, ",");
		}
	}
}

$(document).on("change", ".upload-hidden", function(e){
	readImg(e.target, e.target.id);
});

function readImg(input, imgId){
    // 인풋 태그에 파일이 있는 경우
    if(input.files && input.files[0]) {
        // 이미지 파일인지 검사 (생략)
        const reader = new FileReader()
        // 이미지가 로드가 된 경우
        reader.onload = function (e){
            const previewImage = document.getElementById(imgId+1);
            previewImage.src = e.target.result;
        }
        // reader가 이미지 읽도록 하기
        reader.readAsDataURL(input.files[0]);
    }
}

function comma(obj){
	obj.value = obj.value.replace(/[^0-9]/g,'');   // 입력값이 숫자가 아니면 공백
	obj.value = obj.value.replace(/,/g,'');          // ,값 공백처리
    obj.value = obj.value.replace(/\B(?=(\d{3})+(?!\d))/g, ","); // 정규식을 이용해서 3자리 마다 , 추가 	
}


function keywrdSet(obj){
	var str_space = /\s/;           
    if(str_space.exec(obj.value) || obj.value == null || obj.value == "") {   
        obj.value = obj.value.replaceAll(' ',''); // 공백제거
    }
	var keywrdList = obj.value.split(',');
	var keywrdHtml = '';
	for(var i=0; i<keywrdList.length; i++){
		keywrdHtml += '<div id="keywrd'+i+'"><span>'+keywrdList[i]+'</span><img src="resources/img/mypage/icon-x.png" class="keywrdList" keywrdSq="'+i+'" value="'+keywrdList[i]+'"/></div>';
	}
	$(".key-box").empty();
	$(".key-box").append(keywrdHtml).trigger("create");
}

$(document).on("click", ".keywrdList", function(){
	var keywrdId = document.getElementById("keywrd"+$(this).attr("keywrdSq"));
	keywrdId.remove();
	var keywrdValue = $(this).attr("value");
	var keywrd = $("#keywrd").val().replaceAll(keywrdValue, '');
	$("#keywrd").val(keywrd.substring(0, keywrd.length - 1));
});

function startDateSel(obj){
	result.deal.dealStrtDt = setTodayTime();
	result.deal.dealStrtDtAddDt = parseInt(obj.value);
	if(document.querySelector(".active") != null){
		document.querySelector(".active").className="";
	}
	obj.className = "active";
}

function vaild(){
	if($("input:radio[name='dealPeriod']:checked").val() == "choice"){
		if(result.deal.dealStrtDt == null || result.deal.dealStrtDt == "" ||
			result.deal.dealEndngDt == null || result.deal.dealEndngDt == ""){
			modalAlertShow("판매 기간이 입력되지 않았습니다.");
			return false;
		}
	}else{
		if(result.deal.dealStrtDtAddDt == null || result.deal.dealStrtDtAddDt == ""){
			modalAlertShow("판매 기간을 선택해주세요.");
			return false;
		}
	}
	if(result.deal.dealStrtPrc == null || result.deal.dealStrtPrc == ""){
		modalAlertShow("판매 가격이 입력되지 않았습니다.");
		return false;
	}
	if(result.mbrInfo.mbrDelivryAddr == null || result.mbrInfo.mbrDelivryAddr == ""){
		modalAlertShow("배송 시작 주소가 입력되지 않았습니다.");
		return false;
	}
	if(result.mbrInfo.mbrDelivryCpNum == null || result.mbrInfo.mbrDelivryCpNum == ""){
		modalAlertShow("배송 시작 휴대전화 번호가 입력되지 않았습니다.");
		return false;
	}
	if($("#workGrtUrl1").attr("src") == null || $("#workGrtUrl1").attr("src") == ""){
		modalAlertShow("작품 보증서가 업로드되지 않았습니다.");
		return false;
	}
	if(result.work.workPrc == null || result.work.workPrc == ""){
		modalAlertShow("작품 소장가가 입력되지 않았습니다.");
		return false;
	}
	
	//이미지 용량 확인 체크 시작
	if($("#workGrtUrl").val() != ""){	
		var maxSize = 5 * 1024 * 1024; // 5MB
		var fileSize = $("#workGrtUrl")[0].files[0].size;

		if(fileSize > maxSize){
			modalAlertShow("보증서의 용량이 5MB가 넘습니다. 5MB이상은 첨부파일을 올릴 수 없습니다.", "workGrtUrl");
			return false;
		}
	}else if($("#workImgLefUrl").val() != ""){	
		var maxSize = 5 * 1024 * 1024; // 5MB
		var fileSize = $("#workImgLefUrl")[0].files[0].size;

		if(fileSize > maxSize){
			modalAlertShow("작품 사진(좌)의 용량이 5MB가 넘습니다. 5MB이상은 첨부파일을 올릴 수 없습니다.", "workImgLefUrl");
			return false;
		}
	}else if($("#workImgRitUrl").val() != ""){	
		var maxSize = 5 * 1024 * 1024; // 5MB
		var fileSize = $("#workImgRitUrl")[0].files[0].size;

		if(fileSize > maxSize){
			modalAlertShow("작품 사진(우)의 용량이 5MB가 넘습니다. 5MB이상은 첨부파일을 올릴 수 없습니다.", "workImgRitUrl");
			return false;
		}
	}else if($("#workImgTopUrl").val() != ""){	
		var maxSize = 5 * 1024 * 1024; // 5MB
		var fileSize = $("#workImgTopUrl")[0].files[0].size;

		if(fileSize > maxSize){
			modalAlertShow("작품 사진(상)의 용량이 5MB가 넘습니다. 5MB이상은 첨부파일을 올릴 수 없습니다.", "workImgTopUrl");
			return false;
		}
	}else if($("#workImgBotUrl").val() != ""){	
		var maxSize = 5 * 1024 * 1024; // 5MB
		var fileSize = $("#workImgBotUrl")[0].files[0].size;

		if(fileSize > maxSize){
			modalAlertShow("작품 사진(하)의 용량이 5MB가 넘습니다. 5MB이상은 첨부파일을 올릴 수 없습니다.", "workImgBotUrl");
			return false;
		}
	}
	//이미지 용량 확인 체크 끝
	

	return true;
}

function dealReg(){
	$('#myModal4').modal('hide');
	result.deal.dealTypCd = $("input:radio[name='dealTypCd']:checked").val();
	result.deal.mbrSq = sMbrSqVal;
	if(result.deal.dealTypCd == "A"){
		var dealStrtPrc = $("#dealStrtPrcA").text().replaceAll(" KRW", "");
		result.deal.dealStrtPrc = dealStrtPrc.replaceAll(/,/g,'');
	}else{
		result.deal.dealFinalPrc = $("#dealStrtPrcS").val().replaceAll(/,/g,'');
		result.deal.dealStrtPrc = $("#dealStrtPrcS").val().replaceAll(/,/g,'');
	}
	if($("input:radio[name='delivryAddr']:checked").val() == "N"){
		if($("#mbrDelivryAddr").val() != "" && $("#mbrDelivryAddr").val() != null){
			if($("#mbrDelivryAddrDetail").val() != "" && $("#mbrDelivryAddrDetail").val() != null){
				result.mbrInfo.mbrDelivryAddr = $("#mbrDelivryAddr").val() + " " + $("#mbrDelivryAddrDetail").val();				
			}
			if($("#mbrDelivryCpNum").val() != "" && $("#mbrDelivryCpNum").val() != null){
				result.mbrInfo.mbrDelivryCpNum = $("#mbrDelivryCpNum").val();
			}
		}
	}
	if($("input:radio[name='dealPeriod']:checked").val() == "choice"){
		result.deal.dealStrtDt = $("#dealStrtDt").val() + $("#dealStrtTime").val();
		result.deal.dealEndngDt = $("#dealEndngDt").val() + $("#dealEndngTime").val();
	}
	result.work.keywrd = $("#keywrd").val();
	result.work.mbrSq = sMbrSqVal.toString();
	result.work.artstSq = artstSq;
	result.work.artstActvtyNm = artstActvtyNm;
	result.work.artstBirthYear = artstBirthYear;
	result.work.workVideoUrl = $("#workVideoUrl").val();
	result.work.workIntrdc = $("#workIntrdc").val();
	result.work.workPrc = $("#workPrc").val().replaceAll(/,/g,'');
	result.deal.artstSq = artstSq;
	result.deal.workSq = result.work.workSq.toString();
	result.deal.dealSttsCd = "TP";
	if(vaild()){
		const file = document.getElementsByClassName("upload-hidden");
	    const formData = new FormData();
	    for(var i=0; i<file.length; i++){
	    	formData.append("file", file[i].files[0]);
	    }
	    formData.append("param", new Blob([JSON.stringify(result)], {type: "application/json"}));
	    
	    $.ajax({
	        type: "post",
	        url: "/dealReg/reg",
	        data: formData,
	        contentType : false,
	        processData : false,
	        success: function(data) {
	        	if(data != 0 || data != null || data != ""){
	        		modalAlertShow("성공적으로 저장되었습니다.", "myWork");
	        	}
	        },
	        error: function(error) {
	            alert("오류 발생" + error);
	        }
		});
	}
	
}

function setTodayTime(){
	var now = new Date();
	var year = now.getFullYear().toString();
	var month = (now.getMonth()+1).toString();
	var date = now.getDate().toString();		
	var hours = now.getHours().toString();
	var minutes = now.getMinutes().toString();
	
	return year+'-'+month+'-'+date+' '+hours+':'+minutes;
	
}

      
      $(window).on("resize", function () {
	   	    if(window.matchMedia('(min-width: 1537px)').matches)
	   	    {
	   	    	
	   	    	var swiper = new Swiper(".mySwiper2", {
		   	          slidesPerView: 4,
		   	          spaceBetween: 30,
		   	          slidesPerGroup: 1,
		   	          loop: true,
		   	          loopFillGroupWithBlank: true,
		   	       	  /* autoplay: {
		               delay: 3000,
		               disableOnInteraction: false,
		             }, */
		   	          pagination: {
		   	            el: ".swiper-pagination",
		   	            clickable: true,
		   	          },
		   	          navigation: {
		   	            nextEl: ".swiper-button-next",
		   	            prevEl: ".swiper-button-prev",
		   	          },
		   	        });
	   	    	
		       	  
		       	  
	   	    	
	   	    	
	   	    }  else if(window.matchMedia('(min-width: 751px)').matches) {
	   	    	
	   	    	var swiper = new Swiper(".mySwiper2", {
		   	          slidesPerView: 3,
		   	          spaceBetween: 30,
		   	          slidesPerGroup: 1,
		   	          loop: true,
		   	          loopFillGroupWithBlank: true,
		   	       /* autoplay: {
		               delay: 3000,
		               disableOnInteraction: false,
		             }, */
		   	          pagination: {
		   	            el: ".swiper-pagination",
		   	            clickable: true,
		   	          },
		   	          navigation: {
		   	            nextEl: ".swiper-button-next",
		   	            prevEl: ".swiper-button-prev",
		   	          },
		   	     });
	   	    	
		       	
	   	    	
	   	     } else {
	   	    	var swiper = new Swiper(".mySwiper2", {
		   	          slidesPerView: 2,
		   	       	  spaceBetween: 30,
		   	          slidesPerGroup: 1,
		   	          loop: true,
		   	          loopFillGroupWithBlank: true,
		   	       /* autoplay: {
		               delay: 3000,
		               disableOnInteraction: false,
		             }, */
		   	          pagination: {
		   	            el: ".swiper-pagination",
		   	            clickable: true,
		   	          },
		   	          navigation: {
		   	            nextEl: ".swiper-button-next",
		   	            prevEl: ".swiper-button-prev",
		   	          },
		   	     });
	   	    	
	   	     };
	   	}).resize();
      
      
      
      $(document).ready(function () {
	      $(".elm").hover(
	    	function(){ $(this).addClass('hover') },
	   	    function(){ $(this).removeClass('hover') }
	   	  )
	   	  $(".cn-b").hover(
	    	function(){ $(this).addClass('gis') },
	   	    function(){ $(this).removeClass('gis') }
	   	  )
	   	  
	   	  $("#myModal3").modal("show");
      });
      
      $(function() {                      
    	  $(".bab-bo").click(function() { 
    	    $(this).toggleClass("bashow");     
    	  });
    	  
    	  $(".lg-my").click(function() { 
      	    $('.bg-sh').toggleClass('bg-show');     
      	 	 $('.s-hov').toggleClass('s-hov-show');     
      	  });
    	  
    	  
    	  $(".user-on").click(function() {   
        	    $('.home-1').show();  
        	    $('.home-2').hide()
        	  });
    	  
    	  $(".home-on").click(function() {  
      	    $('.home-1').hide();  
      	    $('.home-2').show()
      	  });
    	  
    	});
      
      
      
      
      /* 메뉴바 FIXED */
      if (jQuery(window).width() > 0) {
          jQuery(window).on("scroll",function(ev){
              if(jQuery(window).scrollTop() > 80 ) { /* 해당 높이를 벗어나면 fixed 클래스 추가 */
                  jQuery('.head-wrap').addClass('fixed');
              }
              else{
                  jQuery('.head-wrap').removeClass('fixed');
              }
              return false;
          });
      }
      
      
      /* jQuery(function($) {

    	    window.onresize = function(){
    	      document.location.reload();
    	    };

    	}); */
      
      
      
      var delay = 300;
      var timer = null;

      //Javascript
      window.addEventListener('resize', function(){
      	clearTimeout(timer);
      	timer = setTimeout(function(){
      		document.location.reload();
      	}, delay);
      });

      //jQuery
      $(window).on('resize', function(){
      	clearTimeout(timer);
      	timer = setTimeout(function(){
      		document.location.reload();
      	}, delay);
      });
      
      $('ul.dropdown-menu.mega-dropdown-menu').on('click', function(event){
    	    // The event won't be propagated up to the document NODE and 
    	    // therefore delegated events won't be fired
    	    event.stopPropagation();
    	});
      
    </script>
    
	
	
	
	
</body>

</html>
