<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <style>
    	.head-wrap{border-bottom:#e9e9e9 1px solid;}
    	.swi-box::before{background-color:#f9f9f9;}
    	.footer-wrap{margin-top:0;}
    	.hd-div{background-color:#fff;}
    	[name=workClrCd]:checked+label{
		  outline: 5px solid gray;
		}
    </style>
</head>

<body>
	<div class="wrap">
		<th:block th:replace="thymeleaf/header :: headerFragment"></th:block>
		<div class="body-wrap coll-mobile">
			
			<div class="contents max-1500">
				<div class="sub-title">
					<h3 class="mo-no">나의 작품 등록 / 수정</h3>
				</div>
				
				<div class="baeg-wrap">
					<!-- <div class="med">
						<h2 class="">작가 정보<span class="c-reds">* 필수 정보</span></h2>
					</div>
					<div class="myd-box">
						<div class="myd-box-2">
							
							<table class="mstyle-2">
								<tr>
									<th><span class="my-red">작가명</span></th>
									<td><input type="text" class="input-4" /></td>
								</tr>
								<tr>
									<th>출생년도</th>
									<td><input type="text" class="input-4" /></td>
								</tr>
							</table>
						</div>
					</div>
					
					<div class="med col_t85">
						<h2 class="">작품 정보 불러오기 <span class="c-gra">※ 이미 등록되어 있는 작품 정보를 불러온 뒤 필요한 정보만 수정하세요.</span></h2>
					</div>
					<div class="myd-box">
						<div class="myd-box-2">
							<div class="input-gra">
								<input type="text" placeholder="작가명을 입력하세요."/>
								<a href="#"><img src="resources/img/mypage/icon-sech.png" /></a>
							</div>
						</div>
					</div> -->
					
					<div class="med">
						<h2 class="">작품 등록 정보 <span class="c-reds">작품 등록을 위한 필수 정보 입니다.</span></h2>
					</div>
					<div class="myd-box">
						<div class="myd-box-2">
							
							<table class="mstyle-2">
								<tr>
									<th><span class="my-red">작품명</span></th>
									<td><input type="text" class="input-4" id="workNm"/></td>
								</tr>
								<tr>
									<th><span class="my-red">사이즈</span></th>
									<td>
										<div class="coll-gr">
											<input type="text" class="input-4" id="workSizeWidth"/>
											<span class="cg-x">X</span> 
											<input type="text" class="input-4" id="workSizeDepth"/>
											<span class="cg-text">cm 37호 입니다</span>
										</div>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">소재/기법</span></th>
									<td><input type="text" class="input-4" id="workMatrl"/></td>
								</tr>
								<tr>
									<th><span class="my-red">제작년도</span></th>
									<td><input type="text" class="input-4" id="workProdcYear"/></td>
								</tr>
								<tr>
									<th><span class="my-red">작품 대표 사진</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled>
											
											<label for="workMainImg">찾아보기</label> 
											<input type="file" id="workMainImg" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품이 꽉 차게 나온 대표 사진 입니다. 관리자가 배경을 제거하고 다시 등록할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">작품사진(전면)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled>
											
											<label for="workImgFrt">찾아보기</label> 
											<input type="file" id="workImgFrt" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품이 꽉 차게 나온 전면 사진 입니다. 관리자가 배경을 제거하고 다시 등록할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">작품사진(후면)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled="disabled">
											
											<label for="workImgRer">찾아보기</label> 
											<input type="file" id="workImgRer" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품이 꽉 차게 나온 전면 사진 입니다. 관리자가 배경을 제거하고 다시 등록할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">액자유무</span></th>
									<td>
										<div class="radio-2">
											<input type="radio" id="w1" name="workFrmYn" value="Y">
											<label for="w1" class="wd-145"><span></span>있음</label>
											<input type="radio" id="w2" name="workFrmYn" value="N">
											<label for="w2"><span></span>없음</label>
										</div>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">판매완료여부</span></th>
									<td>
										<div class="radio-2">
											<input type="radio" id="w3" name="workSaleYn" value="Y">
											<label for="w3" class="wd-145"><span></span>판매완료</label>
											<input type="radio" id="w4" name="workSaleYn" value="N">
											<label for="w4"><span></span>판매전</label>
										</div>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">메인 컬러</span></th>
									<td>
										<div class="color-box">
											<input type="radio" id="mc-1" name="workClrCd" value="MIX"><label for="mc-1" class="mc-1 active"></label>
											<input type="radio" id="mc-2" name="workClrCd" value="RED"><label for="mc-2" class="mc-2"></label>
											<input type="radio" id="mc-3" name="workClrCd" value="ORANGE"><label for="mc-3" class="mc-3"></label>
											<input type="radio" id="mc-4" name="workClrCd" value="YELLOW"><label for="mc-4" class="mc-4"></label>
											<input type="radio" id="mc-5" name="workClrCd" value="GREEN"><label for="mc-5" class="mc-5"></label>
											<input type="radio" id="mc-6" name="workClrCd" value="SKY"><label for="mc-6" class="mc-6"></label>
											<input type="radio" id="mc-7" name="workClrCd" value="BULE"><label for="mc-7" class="mc-7"></label>
											<input type="radio" id="mc-8" name="workClrCd" value="PURPLE"><label for="mc-8" class="mc-8"></label>
											<input type="radio" id="mc-9" name="workClrCd" value="BROWN"><label for="mc-9" class="mc-9"></label>
											<input type="radio" id="mc-10" name="workClrCd" value="WHITE"><label for="mc-10" class="mc-10"></label>
											<input type="radio" id="mc-11" name="workClrCd" value="GRAY"><label for="mc-11" class="mc-11"></label>
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
					
					<div class="med col_t85">
						<h2 class="">거래 등록 정보 <span class="c-gra">등록된 작품을 거래로 전환할 때 필요한 정보 입니다.  미리 등록 할 수도, 거래를 등록할 때 입력하셔도 괜찮습니다.</span></h2>
					</div>
					<div class="myd-box">
						<div class="myd-box-2">
							
							<table class="mstyle-2">
								<tr>
									<th><span class="my-red">보증서</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled>
											
											<label for="workGrtUrl">찾아보기</label> 
											<input type="file" id="workGrtUrl" class="upload-hidden" accept=".jpeg, .jpg, .png, .pdf"> 
										</div>
										<p class="table-p">
											※ png, jpeg, pdf 형식으로 등록 해주세요<br/>
											※ 향후에 거래로 등록 할 때에는 보증서 등록이 필요합니다. 보증서를 분실하셨다면 구매처에 재발급을 요청하시기 바랍니다.
										</p>
									</td>
								</tr>
								<tr>
									<th><span class="my-red">가격</span></th>
									<td><input type="text" class="input-4" id="workPrc"/></td>
								</tr>
								<tr>
									<th><span class="">작품 사진(좌)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled="disabled">
											
											<label for="workImgLefUrl">찾아보기</label> 
											<input type="file" id="workImgLefUrl" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="">작품 사진(우)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled>
											
											<label for="workImgRitUrl">찾아보기</label> 
											<input type="file" id="workImgRitUrl" class="upload-hidden" required> 
										</div>
										<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="">작품 사진(상)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled="disabled">
											
											<label for="workImgTopUrl">찾아보기</label> 
											<input type="file" id="workImgTopUrl" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th><span class="">작품 사진(하)</span></th>
									<td>
										<div class="filebox bs3-primary">
											<input class="upload-name" value="파일선택" disabled="disabled">
											
											<label for="workImgBotUrl">찾아보기</label> 
											<input type="file" id="workImgBotUrl" class="upload-hidden"> 
										</div>
										<p class="table-p">※ 작품의 질감, 액자의 파손, 크랙, 찢어짐 등 작품 상태와 관련된 사진을 등록해 주세요. (최대5장)<br/>배송 완료 시점에 사진과 다른 경우 구매자는 수취를 거부할 수 있습니다.</p>
									</td>
								</tr>
								<tr>
									<th>작품영상</th>
									<td><input type="text" class="input-4" id="workVdoUrl" placeholder="홈페이지, SNS 등 본 작품과 관련된 영상 링크를 기재해 주세요" /></td>
								</tr>
								<tr>
									<th>작품소개</th>
									<td><textarea class="textarea-2" id="workIntrdc" placeholder="작품소개를 입력해주세요."></textarea></td>
								</tr>
								<tr>
									<th><span class="">작품 키워드</span></th>
									<td>
										<input type="text" class="input-4" id="keywrd" placeholder="키워드를 쉼표로 구분해 주세요." onblur="keywrdSet(this)"/>
										<div class="key-box">
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
					
					<div class="bat-box5">
						<button type="button" class="ba-btn1" onclick="myWorkReg()"><span>등록하기</span></button>
						<button type="button" class="ba-btn3" onclick="myWorkStorage()"><span>임시저장</span></button>
						<button type="button" class="ba-btn3" onclick="javascript: window.history.back();"><span>취소</span></button>
					</div>
					
					
				</div>
			</div>
			
			
		</div>
		<th:block th:replace="thymeleaf/footer :: footerFragment"></th:block>
	</div>



<script type="text/javascript">    
$(function() {
	if(sMbrSqVal == null || sMbrSqVal == ""){
		modalAlertShow("잘못된 접근입니다. 메인페이지로 이동합니다.", "main");
	}
}); 

var work = new Object();
work.workTypCd = 'WORK';

$(function() {   
	if(sessionStorage.getItem("work") != null){
		var work1 = new Object();
		work1 = JSON.parse(sessionStorage.getItem("work"));
		$("#workNm").val(work1.workNm);
		$('input:radio[name="workFrmYn"][value="'+work1.workFrmYn+'"]').prop('checked', true);
		$('input:radio[name="workClrCd"][value="'+work1.workClrCd+'"]').prop('checked', true);
		$("#workPrc").val(work1.workPrc);
		$("#workSizeWidth").val(work1.workSizeWidth);
		$("#workSizeDepth").val(work1.workSizeDepth);
		$("#workMatrl").val(work1.workMatrl);
		$("#workProdcYear").val(work1.workProdcYear);
		$("#workVdoUrl").val(work1.workVdoUrl);
		$("#workIntrdc").val(work1.workIntrdc);
		$("#keywrd").val(work1.keywrd);
		$('input:radio[name="workClrCd"][value="'+work1.workSaleYn+'"]').prop('checked', true);
	}
});

function myWorkStorage(){
	modalConfirm("알림", "임시저장시 파일은 저장되지 않습니다. 임시저장하시겠습니까?", 
		function(confirm){
			if(confirm){
				sessionStorage.setItem("work", JSON.stringify({
																workNm : $("#workNm").val(),
																workFrmYn : $('input[name=workFrmYn]:checked').val(),
																workClrCd : $('input[name=workClrCd]:checked').val(),
																workPrc : $("#workPrc").val(),
																workSizeWidth : $("#workSizeWidth").val(),
																workSizeDepth : $("#workSizeDepth").val(),
																workMatrl : $("#workMatrl").val(),
																workProdcYear : $("#workProdcYear").val(),
																workVdoUrl : $("#workVdoUrl").val(),
																workIntrdc : $("#workIntrdc").val(),
																keywrd : $("#keywrd").val(),
																workSaleYn : $('input[name=workSaleYn]:checked').val()
																}));
			}
	});
}

function keywrdSet(obj){
	var str_space = /\s/;           
    if(str_space.exec(obj.value) || obj.value == null || obj.value == "") {   
    	modalAlertShow("해당 항목에는 공백을 사용할 수 없습니다.\n\n공백 제거됩니다.", obj.id);
        obj.value = obj.value.replace(' ',''); // 공백제거
        return false;
    }
	var keywrdList = obj.value.split(',');
	var keywrdHtml = '';
	for(var i=0; i<keywrdList.length; i++){
		keywrdHtml += '<div id="keywrd'+i+'"><span>'+keywrdList[i]+'</span><img src="resources/img/mypage/icon-x.png" class="keywrdList" keywrdSq="'+i+'" value="'+keywrdList[i]+'"/></div>';
	}
	$(".key-box").empty();
	$(".key-box").append(keywrdHtml).trigger("create");
}

$(document).on("click", ".keywrdList", function(){
	debugger;
	var keywrdId = document.getElementById("keywrd"+$(this).attr("keywrdSq"));
	keywrdId.remove();
	var keywrdValue = $(this).attr("value");
	var keywrd = $("#keywrd").val();
	var keywrd2 = keywrd.replaceAll(keywrdValue, '');
	$("#keywrd").val(keywrd2.substring(0, keywrd2.length - 1));
});

function myWorkReg(){
	if(checkValid()){
		work.workPrc = $("#workPrc").val();
		work.workVdoUrl = $("#workVdoUrl").val();
		work.workIntrdc = $("#workIntrdc").val();
		work.keywrd = $("#keywrd").val();
		
		const file = document.getElementsByClassName("upload-hidden");
	    const formData = new FormData();
	    for(var i=0; i<file.length; i++){
	    	formData.append("file", file[i].files[0]);
	    }
	    formData.append("work", new Blob([JSON.stringify(work)], {type: "application/json"}));
	
	
		$.ajax({
	        type: "post",
	        url: "/myWorkReg",
	        data: formData,
	        contentType : false,
	        processData : false,
	        success: function(data) {
	        	alert(data);
	        },
	        error: function(error) {
	            alert("오류 발생" + error);
	        }
		});
	}

}

function checkValid(){
	work.mbrSq = sMbrSqVal;
	work.artstSq = artstSq;
	work.artstNm = artstActvtyNm;
	work.artstEnglsNm = artstEnglsNm;
	work.artstBirthYear = artstBirthYear;
	if($("#workNm").val() != null && $("#workNm").val() != ""){
		work.workNm = $("#workNm").val();
	}else{
		modalAlertShow("작품명이 입력되지 않았습니다!", "workNm");
		return false;
	}
	
	if($("#workSizeWidth").val() != null && $("#workSizeWidth").val() != ""){
		work.workSizeWidth = $("#workSizeWidth").val();
	}else{
		modalAlertShow("사이즈(가로)가 입력되지 않았습니다!", "workSizeWidth");
		return false;
	}
	
	if($("#workSizeDepth").val() != null && $("#workSizeDepth").val() != ""){
		work.workSizeDepth = $("#workSizeDepth").val();
	}else{
		modalAlertShow("사이즈(세로)가 입력되지 않았습니다!", "workSizeDepth");
		return false;
	}
	
	if($("#workMatrl").val() != null && $("#workMatrl").val() != ""){
		work.workMatrl = $("#workMatrl").val();
	}else{
		modalAlertShow("소재/기법이 입력되지 않았습니다!", "workMatrl");
		return false;
	}
	
	if($("#workProdcYear").val() != null && $("#workProdcYear").val() != ""){
		work.workProdcYear = $("#workProdcYear").val();
	}else{
		modalAlertShow("제작년도가 입력되지 않았습니다!", "workProdcYear");
		return false;
	}
	
	if($("#workMainImg").val() == null || $("#workMainImg").val() == ""){
		modalAlertShow("작품 대표 사진이 업로드되지 않았습니다!", "workMainImg");
		return false;
	}
	
	if($("#workImgFrt").val() == null || $("#workImgFrt").val() == ""){
		modalAlertShow("작품 전면 사진이 업로드되지 않았습니다!", "workImgFrt");
		return false;
	}
	
	if($("#workImgRer").val() == null || $("#workImgRer").val() == ""){
		modalAlertShow("작품 후면 사진이 업로드되지 않았습니다!", "workImgRer");
		return false;
	}
	
	if($('input:radio[name=workFrmYn]').is(':checked')){
		work.workFrmYn = $('input[name=workFrmYn]:checked').val();
	}else{
		modalAlertShow("액자 유무가 선택되지 않았습니다!", "w1");	
		return false;
	}
	
	if($('input:radio[name=workSaleYn]').is(':checked')){
		work.workSaleYn = $('input[name=workSaleYn]:checked').val();
	}else{
		modalAlertShow("판매 완료 여부가 선택되지 않았습니다!", "w3");	
		return false;
	}
	
	if($('input:radio[name=workClrCd]').is(':checked')){
		work.workClrCd = $('input[name=workClrCd]:checked').val();
	}else{
		modalAlertShow("메인 컬러가 선택되지 않았습니다!", "mc-1");	
		return false;
	}
	
	return true;
}

/* 파일업로드 */
$(document).ready(function(){
  var fileTarget = $('.filebox .upload-hidden');

    fileTarget.on('change', function(){
        if(window.FileReader){
            var filename = $(this)[0].files[0].name;
        } else {
            var filename = $(this).val().split('/').pop().split('\\').pop();
        }

        $(this).siblings('.upload-name').val(filename);
    });
}); 


     
 $(window).on("resize", function () {
    if(window.matchMedia('(min-width: 1537px)').matches)
    {
    	
    	var swiper = new Swiper(".mySwiper2", {
	          slidesPerView: 4,
	          spaceBetween: 30,
	          slidesPerGroup: 1,
	          loop: true,
	          loopFillGroupWithBlank: true,
	       	  /* autoplay: {
            delay: 3000,
            disableOnInteraction: false,
          }, */
	          pagination: {
	            el: ".swiper-pagination",
	            clickable: true,
	          },
	          navigation: {
	            nextEl: ".swiper-button-next",
	            prevEl: ".swiper-button-prev",
	          },
	        });
    	
    	  
    	  
    	
    	
    }  else if(window.matchMedia('(min-width: 751px)').matches) {
    	
    	var swiper = new Swiper(".mySwiper2", {
	          slidesPerView: 3,
	          spaceBetween: 30,
	          slidesPerGroup: 1,
	          loop: true,
	          loopFillGroupWithBlank: true,
	       /* autoplay: {
            delay: 3000,
            disableOnInteraction: false,
          }, */
	          pagination: {
	            el: ".swiper-pagination",
	            clickable: true,
	          },
	          navigation: {
	            nextEl: ".swiper-button-next",
	            prevEl: ".swiper-button-prev",
	          },
	     });
    	
    	
    	
     } else {
    	var swiper = new Swiper(".mySwiper2", {
	          slidesPerView: 2,
	       	  spaceBetween: 30,
	          slidesPerGroup: 1,
	          loop: true,
	          loopFillGroupWithBlank: true,
	       /* autoplay: {
            delay: 3000,
            disableOnInteraction: false,
          }, */
	          pagination: {
	            el: ".swiper-pagination",
	            clickable: true,
	          },
	          navigation: {
	            nextEl: ".swiper-button-next",
	            prevEl: ".swiper-button-prev",
	          },
	     });
    	
     };
}).resize();
     
     
     
 $(document).ready(function () {
  $(".elm").hover(
	function(){ $(this).addClass('hover') },
    function(){ $(this).removeClass('hover') }
  )
  $(".cn-b").hover(
	function(){ $(this).addClass('gis') },
    function(){ $(this).removeClass('gis') }
  )
 });
 
 $(function() {                      
  $(".bab-bo").click(function() { 
    $(this).toggleClass("bashow");     
  });
  
  $(".lg-my").click(function() { 
 	    $('.bg-sh').toggleClass('bg-show');     
 	 	 $('.s-hov').toggleClass('s-hov-show');     
 	  });
  
});
     
     
     
     
/* 메뉴바 FIXED */
if (jQuery(window).width() > 0) {
    jQuery(window).on("scroll",function(ev){
        if(jQuery(window).scrollTop() > 80 ) { /* 해당 높이를 벗어나면 fixed 클래스 추가 */
            jQuery('.head-wrap').addClass('fixed');
        }
        else{
            jQuery('.head-wrap').removeClass('fixed');
        }
        return false;
    });
}

     
 /* jQuery(function($) {

    window.onresize = function(){
      document.location.reload();
    };

}); */
 
 
 
 var delay = 300;
 var timer = null;

 //Javascript
 window.addEventListener('resize', function(){
 	clearTimeout(timer);
 	timer = setTimeout(function(){
 		document.location.reload();
 	}, delay);
 });

 //jQuery
 $(window).on('resize', function(){
 	clearTimeout(timer);
 	timer = setTimeout(function(){
 		document.location.reload();
 	}, delay);
 });
 
 $('ul.dropdown-menu.mega-dropdown-menu').on('click', function(event){
    // The event won't be propagated up to the document NODE and 
    // therefore delegated events won't be fired
    event.stopPropagation();
});
 
 
</script>
    
	
	
	
	
</body>

</html>
