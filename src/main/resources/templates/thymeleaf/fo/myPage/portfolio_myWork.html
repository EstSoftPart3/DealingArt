<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
	<style>
    	.head-wrap{border-bottom:#e9e9e9 1px solid;}
    </style>
    
    <link rel="icon" type="image/png" href="/resources/img/favicon.png">
    
</head>

<body>
	<div class="wrap">
		<th:block th:replace="thymeleaf/header :: headerFragment"></th:block>
		
		<div class="body-wrap">
			<div class="contents">
				<div th:text="${session.mbrSq}" id="mbrSq" style="display:none"></div>
				<div class="con-wrap pop-wrap">
				
					<th:block th:replace="thymeleaf/myPageLeft :: myPageLeftFragment"></th:block>
					
					<div class="con-right">
					
						<div class="reds-box mg_t150 por">
							<ul class="pc-on">
								<li>
									<a href="javascript:fnModalAlert();" class="up-on">
										최신 순
									</a>
								</li>
								<li>
									<a href="javascript:fnModalAlert();" class="down-on">
										가격
									</a>
								</li>
							</ul>
<!-- 							<div class="med-ic"> -->
<!-- 								<div class="por"> -->
<!-- 									<div class="tootip-5">설정/공유</div> -->
<!-- 									<img src="/resources/img/mypage/icon-8.png" class="med-me"> -->
<!-- 								</div> -->
<!-- 							</div> -->
						</div>
						
						<div id="div_noneMyWork" style="display:none;">
							<div class="t_1"><span class="c-red">
								등록된 작품</span>이 없습니다.<br><span class="c-red">작품을 등록</span>해보세요!
							</div>
	                        <div class="bat-box3-1 mg_t65" style="text-align:center;">
								<button type="button" class="ba-btn1" onclick="myWorkRegMove()"><span>작품 등록하러 가기</span></button>
							</div>
						</div>
						
    
							<style type="text/css">
								
								.pseudo-img {
								  border-radius: 7px;-moz-border-radius: 7px;-khtml-border-radius: 7px;-webkit-border-radius: 7px
								}
								
								.grid{border:0px solid #222;text-align:center;margin: 0 auto;}
 								.griditem{ margin-bottom:10px;}

							</style>
							
							
						    
						    <!-- 작품 리스트  -->
					  	<div class="grid" style= "cursor: pointer;">

								 
							</div>
						
					</div>
					
				
				</div>
				
			</div>
		</div>
		<th:block th:replace="thymeleaf/footer :: footerFragment"></th:block>
	</div>
	



<script th:inline="javascript">
var result = /*[[${result}]]*/ 'default';
$(function() { 
	if(sAuthSqVal == 2){
		document.getElementById("portfolio").style.display=""; 
	}
	$("#conTitle").empty();
	$("#conBtn").empty();
	const conBtn = document.getElementById("conBtn");
	conBtn.style.display = "";
	var conTitleHtml = "";
	conTitleHtml += '<h3>포트폴리오</h3>';
	$("#conTitle").append(conTitleHtml).trigger("create");
	//conBtn.innerHTML += '<a href="/myWork_reg"><img src="resources/img/mypage/mycon-1.png" /></a>';
	conBtn.innerHTML += '<a href="javascript:myWorkRegMove();"><img src="resources/img/mypage/mycon-1.png" /></a>';
	conBtn.innerHTML += '<a href="javascript:fnModalAlert();"><img src="resources/img/mypage/mycon-2.png" /></a>';
	
	$("#myWork").addClass("active");
	
	 myWorkList();
});   

function myWorkRegMove() {
	
	modalConfirm("알림", "시스템 기능 개선으로 인하여 삭제 및 비공개 처리가 불가능합니다. 등록하시겠습니까?", 
	
	function(confirm){
		if(confirm){
				location.href = "/myWork_reg";					
		}
	});

}
function myWorkList(){
	if(result.length > 0){
		var html = "";
			
		for(var i=0; i<result.length; i++){
			
			if(i != 0){
				var z = i+1
				var gtText = "gt"+z;
			}	
			
			//경매 - 겨래진행중
			if(result[i].dealTypCd == "A" && result[i].dealSttsCd == "TP"){
				
				html += '<div class="griditem '+gtText+'" style="border:0px solid #222;" >';
				html += '<div>';
				html += '<div class="item-div-img active-on">';
				//작품 이미지
				//html += '	<img src="'+ result[i].workMainImgUrl +'" class="pseudo-img" style="max-width:360px; max-height:600px; width:100%; height:100%;">';
				
				html += '		<div class="item-ho" style="cursor:pointer" onclick="biddingMove('+result[i].workSq+')">';
				html += '			<p>'+ result[i].dealStrtDate +' - '+ result[i].dealEndngDate +'</p>';
 				html += '			<p> 응찰수 : '+ result[i].bidCnt +'</p>';
 				html += '			<ul class="dealCount" dday="'+result[i].dealEndngDateTime+'"></ul>';
 				html += '			<h4>시작가 '+ result[i].dealStrtPrc +' KRW</h4>';
				
				/* html += '			<p class="ts-2">';
				html += '			'+ result[i].dealStrtDate +' – '+ result[i].dealEndngDate +'<br/>';
				html += '			응찰수 : '+ result[i].bidCnt +'<br/>';
				html += '			'+ result[i].dealRemainingDay +'일 '+ result[i].dealRemainingHour +'시 '+ result[i].dealRemainingMin +'분 '+ result[i].dealRemainingSec +'초';
				html += '			</p>'; 
				if(result[i].maxBidPrc == null) {
					html += '			<h4>입찰가 : '+ formatComma(result[i].dealStrtPrc) +'</h4>';
				} else {
					html += '			<h4>입찰가 : '+ formatComma(result[i].maxBidPrc) +'</h4>';	
				} */
				
				html += '		</div>';
				
				html += '</div>'
				
				html += '<div class="item-body">';
				
				html += '<div>';
				html += '<div class="uesr-s">';
				if(result[i].artstProfileImgUrl == null || result[i].artstProfileImgUrl == ""){
 				html += '<img src="resources/img/de/ues-icon.png"/>';
 				}else{
 				html += '<img src="'+ result[i].artstProfileImgUrl +'" style="width:42px;border-radius: 7px;-moz-border-radius: 7px;-khtml-border-radius: 7px;-webkit-border-radius: 7px"/>';
 				}
				html += '</div>';
				
				
				html += '<div class="text-s" style="padding-left:5px;text-align:left">';
				
				html += '<h3>'+ result[i].artstActvtyNm +' ('+ result[i].artstBirthYear +')</h3>';
				html += '<p class="ts-1">'+ result[i].workNm +' ('+ result[i].workProdcYear +')</p>';
				html += '<p>'+ result[i].workMatrl +'</p>';
				html += '<p>'+ result[i].workSizeDepth +'x'+ result[i].workSizeWidth +'</p>';
				
				if(result[i].dealTypCd == "A"){
					if(result[i].maxBidPrc != null && result[i].maxBidPrc != "") {
 					html += '<h4>입찰가 '+ formatComma(result[i].maxBidPrc) +' KRW</h4>';
					} else {
						html += '<h4>입찰가 0 KRW</h4>';
					}
 			     }
				html += '<h4>- <a href="javascript:myWorkMod('+result[i].workSq+')">작품수정</a></h4>';
 				html += '<h4>- <a href="javascript:workDetailMove('+result[i].workSq+')">상세보기</a></h4>';
				html += '</div>'
				
				html += '</div>';
				
				if(result[i].authSq == 2){
 				html += '<div class="artist active"><span>Artist</span></div>';
 			}
 			if(result[i].authSq == 1){
 				html += '<div class="artist"><span>Artist</span></div>';
 			}
				
				html += '</div>';
				html += '</div>';
				html += '</div>';
				
			}
			
			//판매 - 거래진행중
			if(result[i].dealTypCd == "S" && result[i].dealSttsCd == "TP"){
				
				html += '<div class="griditem '+gtText+'" style="border:0px solid #222;" >';
				html += '<div>';
				//작품 이미지
				html += '<div class="item-div-img sale-on" style="cursor:pointer" onclick="biddingMove('+result[i].workSq+')">';
				html += '<img src="'+ result[i].workMainImgUrl +'" class="pseudo-img" style="max-width:360px; max-height:600px; width:100%; height:100%;">';
				html += '		<div class="item-ho2 sale-div">';
	 			html += '			<h3>판매중</h3>';
	 			html += '				<ul class="dealCount" dday="'+result[i].dealEndngDateTime+'"></ul>';
	 			html += '		</div>';
				html += '</div>';
				html += '<div class="item-body">';
				
				html += '<div>';
				html += '<div class="uesr-s">';
				if(result[i].artstProfileImgUrl == null || result[i].artstProfileImgUrl == ""){
 				html += '<img src="resources/img/de/ues-icon.png"/>';
 				}else{
 				html += '<img src="'+ result[i].artstProfileImgUrl +'" style="width:42px;border-radius: 7px;-moz-border-radius: 7px;-khtml-border-radius: 7px;-webkit-border-radius: 7px"/>';
 				}
				html += '</div>';
				
				
				html += '<div class="text-s" style="padding-left:5px;text-align:left">';
				
				html += '<h3>'+ result[i].artstActvtyNm +' ('+ result[i].artstBirthYear +')</h3>';
				html += '<p class="ts-1">'+ result[i].workNm +' ('+ result[i].workProdcYear +')</p>';
				html += '<p>'+ result[i].workMatrl +'</p>';
				html += '<p>'+ result[i].workSizeDepth +'x'+ result[i].workSizeWidth +'</p>';
				
				html += '<h4>판매가 '+ formatComma(result[i].dealStrtPrc) +' KRW</h4>';
				
				html += '<h4>- <a href="javascript:myWorkMod('+result[i].workSq+')">작품수정</a></h4>';
 				html += '<h4>- <a href="javascript:workDetailMove('+result[i].workSq+')">상세보기</a></h4>';
 				
				html += '</div>'
				
				html += '</div>';
				
				if(result[i].authSq == 2){
 				html += '<div class="artist active"><span>Artist</span></div>';
 			}
 			if(result[i].authSq == 1){
 				html += '<div class="artist"><span>Artist</span></div>';
 			}
 		
				
				html += '</div>';
				html += '</div>';
				html += '</div>';
					

			}
			
			//거래종료
			if(result[i].dealSttsCd != "TP" && result[i].dealTypCd != null && result[i].dealTypCd != ""){
				
				html += '<div class="griditem '+gtText+'" style="border:0px solid #222;">';
				html += '<div >';
				html += '<div class="item-div-img sold-3" style="cursor:pointer;">';
				//작품 이미지
				html += '<img src="'+ result[i].workMainImgUrl +'" class="pseudo-img" style="max-width:360px; max-height:600px; width:100%; height:100%;">';
				html += '</div>';
				html += '<div class="item-body">';
				
				html += '<div>';
				html += '<div class="uesr-s">';
				if(result[i].artstProfileImgUrl == null || result[i].artstProfileImgUrl == ""){
 				html += '<img src="resources/img/de/ues-icon.png"/>';
 			}else{
 				html += '<img src="'+ result[i].artstProfileImgUrl +'" style="width:42px;border-radius: 7px;-moz-border-radius: 7px;-khtml-border-radius: 7px;-webkit-border-radius: 7px"/>';
 			}
				html += '</div>';
				
				
				html += '<div class="text-s" style="padding-left:5px;text-align:left">';
				
				html += '<h3>'+ result[i].artstActvtyNm +' ('+ result[i].artstBirthYear +')</h3>';
				html += '<p class="ts-1">'+ result[i].workNm +' ('+ result[i].workProdcYear +')</p>';
				html += '<p>'+ result[i].workMatrl +'</p>';
				html += '<p>'+ result[i].workSizeDepth +'x'+ result[i].workSizeWidth +'</p>';
				html += '</div>'
				
				html += '</div>';
				
				if(result[i].authSq == 2){
 				html += '<div class="artist active"><span>Artist</span></div>';
 			}
 			if(result[i].authSq == 1){
 				html += '<div class="artist"><span>Artist</span></div>';
 			}
				
				html += '</div>';
				html += '</div>';
				html += '</div>';

			}

			
			if(result[i].dealTypCd == null || result[i].dealTypCd == ""){
			
				html += '<div class="griditem '+gtText+'" style="border:0px solid #222;">';
				html += '<div >';
				html += '<div class="item-div-img reg">';
				//작품 이미지
				html += '<img src="'+ result[i].workMainImgUrl +'" class="pseudo-img" style="max-width:360px; max-height:600px; width:100%; height:100%;">';
				html += '	<div class="item-ho3 reg-div">';
				html += '		<div class="regs" >';
				html += '			<a href="#" class="reg-a" workSq="'+ result[i].workSq +'" onclick="dealReg(this)"><span>거래 등록</span></a>';
				html += '			<a href="#" class="cor-a" workSq="'+ result[i].workSq +'" onclick="myWorkMod('+ result[i].workSq +')"><span>작품 수정</span></a>';
				html += '			<a href="javascript:workDetailMove('+ result[i].workSq +')" class="cor-a"><span>상세보기</span></a>';
				html += '		</div>';
				html += '	</div>';
				html += '</div>';
				html += '<div class="item-body">';
				html += '<div>';
				html += '<div class="uesr-s">';
			if(result[i].artstProfileImgUrl == null || result[i].artstProfileImgUrl == ""){
				html += '<img src="resources/img/de/ues-icon.png"/>';
			}else{
				html += '<img src="'+ result[i].artstProfileImgUrl +'" style="width:42px;border-radius: 7px;-moz-border-radius: 7px;-khtml-border-radius: 7px;-webkit-border-radius: 7px"/>';
			}
			html += '</div>';
			
			
			html += '<div class="text-s" style="padding-left:5px;text-align:left">';
			
			html += '<h3>'+ result[i].artstActvtyNm +' ('+ result[i].artstBirthYear +')</h3>';
			html += '<p class="ts-1">'+ result[i].workNm +' ('+ result[i].workProdcYear +')</p>';
			html += '<p>'+ result[i].workMatrl +'</p>';
			html += '<p>'+ result[i].workSizeDepth +'x'+ result[i].workSizeWidth +'</p>';
			html += '</div>'
			
			html += '</div>';
			
			if(result[i].authSq == 2){
				html += '<div class="artist active"><span>Artist</span></div>';
			}
			if(result[i].authSq == 1){
				html += '<div class="artist"><span>Artist</span></div>';
			}
			
			html += '</div>';
			html += '</div>';
			html += '</div>';

		}

		}
	
		$(".grid").append(html);
		//$("#masonryList").append(html);
		masonryLayout();
    }else{
    	$("#div_noneMyWork").css("display", "");
		//modalAlertShow("등록 된 작품이 없습니다.");
    }
     
}
//거래 남은 시간 1초마다 계산해서 표현하기
setInterval(function() {
	var elements = document.querySelectorAll(".dealCount");
	for(var i=0; i<elements.length; i++){
		var html = '';
		var dday = new Date(elements[i].attributes.dday.value).getTime();
		var today = new Date().getTime();
		if(today >= dday){
			dealSearch();
		}
	  	var gap = dday - today;
		var day = Math.ceil(gap / (1000 * 60 * 60 * 24));
		var hour = Math.ceil((gap % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60) - 1);
		var min = Math.ceil((gap % (1000 * 60 * 60)) / (1000 * 60));
		var sec = Math.ceil((gap % (1000 * 60)) / 1000);
		html += '<li>'+ day +'<span>day</span></li>';
		html += '<li>'+ hour +'<span>hrs</span></li>';
		html += '<li>'+ min +'<span>min</span></li>';
		html += '<li>'+ sec +'<span>sec</span></li>';
		elements[i].innerHTML = html;
	  	//document.getElementById("dealCount").innerHTML = day + " 일 " + hour + " : " + min + " : " + sec;
	}
}, 1000);


 $(window).on("resize", function () {
	 
	 if(window.matchMedia('(min-width: 1537px)').matches) {
		$(".grid").width( '1200px' );
	 }
 }).resize();

function myWorkMod(obj){
	var workSq = obj.getAttribute("workSq");
	location.href = "/myWorkMod?workSq="+workSq;
}

function dealReg(obj){
	var workSq = obj.getAttribute("workSq");
	location.href = "/dealReg?workSq="+workSq+"&&mbrSq="+sMbrSqVal+"&&workTypCd=WORK";
}

$(document).on("click", ".heart", function(){
	var param = new Object();
	var element = $(this);
	param.workSq= element.attr("workSq");
	param.mbrSq = sMbrSqVal;
	if($(this).hasClass("on")){
		$.ajax({
	        type: "post",
	        url: "/scrapDel",
	        data: param,
	        success: function(data) {
	        	element.removeClass("on");
	        	element.addClass("off");
	        },
	        error: function(error) {
	            alert("오류 발생" + error);
	        }
		});
	}else{
		$.ajax({
	        type: "post",
	        url: "/scrapAdd",
	        data: param,
	        success: function(data) {
	        	if(data == 1){
	        		element.addClass("on");
	        	}else{
	        		modalAlertShow("스크랩 등록에 실패했습니다. 관리자에게 문의하세요.");
	        	}
	        },
	        error: function(error) {
	            alert("오류 발생" + error);
	        }
		});
	}
});
      
 
 
 
 $(document).ready(function () {
  $(".elm").hover(
	function(){ $(this).addClass('hover') },
    function(){ $(this).removeClass('hover') }
  )
  $(".cn-b").hover(
	function(){ $(this).addClass('gis') },
    function(){ $(this).removeClass('gis') }
  )
 });
 
 $(function() {                      
  $(".bab-bo").click(function() { 
    $(this).toggleClass("bashow");     
  });
  
  $(".lg-my").click(function() { 
 	    $('.bg-sh').toggleClass('bg-show');     
 	 	 $('.s-hov').toggleClass('s-hov-show');     
 	  });
  
});
 
 
 
 
 /* 메뉴바 FIXED */
 if (jQuery(window).width() > 0) {
     jQuery(window).on("scroll",function(ev){
         if(jQuery(window).scrollTop() > 80 ) { /* 해당 높이를 벗어나면 fixed 클래스 추가 */
             jQuery('.head-wrap').addClass('fixed');
         }
         else{
             jQuery('.head-wrap').removeClass('fixed');
         }
         return false;
     });
 }
 


 
 $('ul.dropdown-menu.mega-dropdown-menu').on('click', function(event){
    // The event won't be propagated up to the document NODE and 
    // therefore delegated events won't be fired
    event.stopPropagation();
});
 
 
 //화면 레이아웃 추가
	function masonryLayout() {
		
		var msnry = new Masonry( '.grid', {

			
		  	  itemSelector: '.griditem',
		  	  columnWidth: 360,
		  	  gutter: 10,
		  	  horizontalOrder: true,
		  	  // originLeft: false //왼쪽부터 정렬 
		  	  // originTop: false //바닥부터
		  	  transitionDuration: '0.2s' //위치 전환 시간
		});
		
		imagesLoaded( '.grid' ).on( 'progress', function() {
			msnry.layout();
		});
	}
 
 
  	function workDetailMove(workSq){
  	 	location.href="/workDetail?workSq="+workSq;
  	}


	function biddingMove(workSq) {
		
		pageGoPost({
			url:"/bidding",
			target:"_self",
			vals:[
				["workSq", workSq]
			]
		});
		
	}
	
	
	//작품수정
  	function myWorkMod(workSq){
  		location.href = "/myWorkMod?workSq="+workSq;
  	}
  	//상세보기
  	function workDetailMove(workSq){
  	 	location.href="/workDetail?workSq="+workSq;
  	}
      
</script>
    
	
	
	
	
</body>

</html>
