<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.da.mapper.ArtistMapper">
	<select id="upAndComingArtist" resultType="hashMap" parameterType="hashMap">
		/*아티스트 라이브러리 신진 작가 조회*/
		SELECT 
				A.ARTST_SQ AS artstSq, 
				A.ARTST_ACTVTY_NM AS artstActvtyNm, /*작가 이름*/
				A.ARTST_ENGLS_NM AS artstEnglsNm, /*작가 영어 이름*/
				A.ARTST_PROFILE_IMG_URL AS artstProfileImgUrl, /*작가 프로필 사진*/
				A.ARTST_SELF_INTRO AS artstSelfIntro, /*작가 소개*/
				A.ARTST_WORK_IMG_URL AS artstWorkImgUrl, /*작가 작품 대표 사진*/
				YEAR (B.MBR_BIRTH) AS artistBirthYear /*작가 생년*/
		FROM
				TBL_DA_ARTST_M AS A
		INNER JOIN 
				TBL_DA_MBR_M AS B 
			ON 	A.MBR_SQ = B.MBR_SQ  
		/*WHERE
				YEAR (B.MBR_BIRTH) BETWEEN '1980' AND YEAR (NOW())*/
	</select>
	
	<select id="middleAgedArtist" resultType="hashMap" parameterType="hashMap">
		/*아티스트 라이브러리 중견 작가 조회*/
		SELECT 
				A.ARTST_SQ AS artstSq, 
				A.ARTST_ACTVTY_NM AS artstActvtyNm, /*작가 이름*/
				A.ARTST_ENGLS_NM AS artstEnglsNm, /*작가 영어 이름*/
				A.ARTST_PROFILE_IMG_URL AS artstProfileImgUrl, /*작가 프로필 사진*/
				A.ARTST_SELF_INTRO AS artstSelfIntro, /*작가 소개*/
				A.ARTST_WORK_IMG_URL AS artstWorkImgUrl, /*작가 작품 대표 사진*/
				YEAR (B.MBR_BIRTH) AS artistBirthYear /*작가 생년*/
		FROM
				TBL_DA_ARTST_M AS A
		INNER JOIN 
				TBL_DA_MBR_M AS B 
			ON 	A.MBR_SQ = B.MBR_SQ  
		/*WHERE
				YEAR (B.MBR_BIRTH) BETWEEN '1965' AND '1979'*/
	</select>
	
	<select id="seniorArtist" resultType="hashMap" parameterType="hashMap">
		/*아티스트 라이브러리 원로 작가 조회*/
		SELECT 
				A.ARTST_SQ AS artstSq, 
				A.ARTST_ACTVTY_NM AS artstActvtyNm, /*작가 이름*/
				A.ARTST_ENGLS_NM AS artstEnglsNm, /*작가 영어 이름*/
				A.ARTST_PROFILE_IMG_URL AS artstProfileImgUrl, /*작가 프로필 사진*/
				A.ARTST_SELF_INTRO AS artstSelfIntro, /*작가 소개*/
				A.ARTST_WORK_IMG_URL AS artstWorkImgUrl, /*작가 작품 대표 사진*/
				YEAR (B.MBR_BIRTH) AS artistBirthYear /*작가 생년*/
		FROM
				TBL_DA_ARTST_M AS A
		INNER JOIN 
				TBL_DA_MBR_M AS B 
			ON 	A.MBR_SQ = B.MBR_SQ  
		/*WHERE
				YEAR (B.MBR_BIRTH) BETWEEN '1950' AND '1964'*/
	</select>
	
	<select id="artistInfo" resultType="hashMap" parameterType="hashMap">
	/*작가 정보*/
		SELECT 
				ARTST_SQ  AS artstSq, /*작가 순번*/
				ARTST_ACTVTY_NM AS artstActvtyNm, /*작가 활동명*/
				ARTST_ENGLS_NM AS artstEnglsNm, /*작가 영문명*/
				ARTST_SELF_INTRO AS artstSelfIntro, /*작가 자기소개*/
				ARTST_FACEBOOK_URL AS artstfacebookUrl, /*작가 페이스북 주소*/
				ARTST_INSTAGRAM_URL AS artstInstagramUrl, /*작가 인스타그램 주소*/
				ARTST_HMPG_URL AS artstHmpgUrl, /*작가 홈페이지 주소*/
				ARTST_PROMTN_VIDEO_URL AS artstPromtnVideoUrl /*작가 홍보 비디오 주소*/
		FROM 
				TBL_DA_ARTST_M
		WHERE 
				ARTST_SQ = #{artstSq}
	</select>
	
	<select id="artistInfoEductn" resultType="hashMap" parameterType="hashMap">
	/*작가 학력 리스트*/
		SELECT 
				A.EDUCTN_SQ AS eductnSq, /*작가 학력 순번*/
				A.EDUCTN_NM AS eductnNm, /*작가 학력 명*/
				YEAR (A.EDUCTN_ENDNG_DATE) AS eductnEndngDate /*작가 학력 종료 일자*/
		FROM 
				TBL_DA_ARTST_EDUCTN_S AS A
		INNER JOIN 
				TBL_DA_ARTST_M AS B
			ON 	A.ARTST_SQ = B.ARTST_SQ
		WHERE 
				B.ARTST_SQ = #{artstSq}
		ORDER BY 
				A.EDUCTN_ENDNG_DATE DESC 
	</select>
	
	<select id="artistInfoCareer" resultType="hashMap" parameterType="hashMap">
	/*작가 경력 리스트*/
		SELECT 
				A.CAREER_SQ AS careerSq, /*경력 순번*/
				A.CAREER_NM AS careerNm, /*경력 명*/
				YEAR (A.CAREER_ENDNG_DATE) AS careerEndngDate /*경력 종료 일자*/
		FROM 
				TBL_DA_ARTST_CAREER_S AS A
		INNER JOIN 
				TBL_DA_ARTST_M AS B
			ON 	A.ARTST_SQ = B.ARTST_SQ 
		WHERE 
				A.ARTST_SQ = #{artstSq}
		ORDER BY 
				A.CAREER_ENDNG_DATE DESC
	</select>
	
	<select id="artistInfoExhbtn" resultType="hashMap" parameterType="hashMap">
	/*작가 전시 리스트*/
		SELECT 
				A.EXHBTN_SQ AS exhbtnSq, /*전시 순번*/
				A.EXHBTN_NM AS exhbtnNm, /*전시 명*/
				YEAR (A.EXHBTN_ENDNG_DATE) AS exhbtnEndngDate /*전시 종료 일자*/
		FROM 	
				TBL_DA_ARTST_EXHBTN_S AS A
		INNER JOIN 
				TBL_DA_ARTST_M AS B
			ON 	A.ARTST_SQ = B.ARTST_SQ
		WHERE 
				A.ARTST_SQ = #{artstSq}
		ORDER BY 
				A.EXHBTN_ENDNG_DATE DESC
	</select>
	
	<select id="artistWorkList" resultType="hashMap" parameterType="hashMap">
	/*작가 작품 리스트*/
		SELECT 
				A.WORK_SQ AS workSq, /*작품번호*/
				A.MBR_SQ AS mbrSq, /*멤버번호*/
				A.ARTST_SQ AS artstSq, /*작가번호*/
				D.AUTH_SQ AS authSq, /*작가구분*/
				E.ARTST_ACTVTY_NM AS artstActvtyNm, /*작가활동명*/
				E.ARTST_ENGLS_NM AS artstEnglsNm, /*작가영문명*/
				YEAR (D.MBR_BIRTH) AS artstBirthYear, /*작가생년월일*/
				E.ARTST_PROFILE_IMG_URL AS artstProfileImgUrl, /*작가프로필사진주소*/
				F.DEAL_TYP_CD AS dealTypCd, /*거래유형*/
				F.DEAL_STTS_CD AS dealSttsCd, /*거래상태*/
				A.WORK_NM AS workNm, /*작품명*/
				A.WORK_MATRL AS workMatrl, /*작품소재*/
				A.WORK_MAIN_IMG_URL AS workMainImgUrl, /*작품대표이미지주소*/
				A.WORK_SIZE_HEIGHT AS workSizeHeight, /*작품사이즈높이*/
				A.WORK_SIZE_WIDTH AS workSizeWidth, /*작품사이즈가로*/
				A.WORK_SIZE_DEPTH AS workSizeDepth, /*작품사이즈세로/
				A.WORK_PRODC_YEAR AS workProdcYear, /*작품제작년도*/
				C.MAX_BID_PRC AS maxBidPrc, /*작품응찰가격*/
				F.DEAL_STRT_PRC AS dealStrtPrc, /*거래시작가격*/
				F.DEAL_SBID_PRC AS dealSbidPrc, /*거래낙찰가격*/
				B.BID_CNT AS bidCnt, /*응찰수*/ 
				DATE_FORMAT(F.DEAL_STRT_DATE, '%Y.%m.%d') AS dealStrtDate, /*거래시작일시*/
				DATE_FORMAT(F.DEAL_ENDNG_DATE, '%Y.%m.%d') AS dealEndngDate, /*거래종료일시*/
				DATEDIFF(F.DEAL_ENDNG_DATE, NOW()) AS dealRemainingDay, /*거래남은일자*/
				DATE_FORMAT(TIMEDIFF(DATE_FORMAT(F.DEAL_ENDNG_DATE, '%H:%i:%s'), DATE_FORMAT(NOW(), '%H:%i:%s')), '%H') AS dealRemainingHour, /*거래남은시*/
				DATE_FORMAT(TIMEDIFF(DATE_FORMAT(F.DEAL_ENDNG_DATE, '%H:%i:%s'), DATE_FORMAT(NOW(), '%H:%i:%s')), '%i') AS dealRemainingMin, /*거래남은분*/
				DATE_FORMAT(TIMEDIFF(DATE_FORMAT(F.DEAL_ENDNG_DATE, '%H:%i:%s'), DATE_FORMAT(NOW(), '%H:%i:%s')), '%s') AS dealRemainingSec /*거래남은초*/
		FROM 
				TBL_DA_WORK_M AS A,
				(SELECT DEAL_SQ , COUNT(DEAL_SQ) AS BID_CNT
				FROM TBL_DA_AUCTN_BID_H 
				GROUP BY DEAL_SQ) AS B,
				(SELECT DEAL_SQ, MAX(BID_PRC) AS MAX_BID_PRC
				FROM TBL_DA_AUCTN_BID_H
				GROUP BY DEAL_SQ) AS C,
				TBL_DA_MBR_M AS D,
				TBL_DA_ARTST_M AS E,
				TBL_DA_DEAL_M AS F
		WHERE 
				A.MBR_SQ = D.MBR_SQ 
				AND A.ARTST_SQ = E.ARTST_SQ
				AND A.WORK_SQ = F.WORK_SQ
				AND B.DEAL_SQ = F.DEAL_SQ
				AND C.DEAL_SQ = F.DEAL_SQ
				AND E.ARTST_SQ = #{artstSq}
	</select>

</mapper>